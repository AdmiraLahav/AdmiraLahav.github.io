<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fake Linux Terminal â€” GitHub Pages</title>
<style>
  :root {
    --bg:#0b0f12;
    --panel:#071018;
    --text:#cfe8ff;
    --muted:#88a0b3;
    --accent:#66d9ef;
    --green:#27ff27;
    --blue:#3ea6ff;
    --white:#ffffff;
    --red:#ff4c4c;
  }
  html,body {
    height:100%; margin:0;
    font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
    background:linear-gradient(180deg,#030506 0%, #071018 100%);
    color:var(--text);
  }

  .login-wrap{height:100%;display:flex;align-items:center;justify-content:center}
  .login{width:420px;padding:28px;border-radius:8px;background:rgba(255,255,255,0.02);box-shadow:0 6px 30px rgba(0,0,0,0.6);backdrop-filter:blur(4px)}
  .login h1{margin:0 0 10px;font-size:20px;color:var(--accent)}
  .login label{display:block;font-size:12px;color:var(--muted);margin-top:12px}
  .login input{width:100%;padding:10px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:rgba(255,255,255,0.02);color:var(--text);outline:none}
  .btn{margin-top:14px;padding:10px;border-radius:6px;border:none;width:100%;cursor:pointer;background:var(--accent);color:#02131a;font-weight:700}
  .small{font-size:12px;color:var(--muted);margin-top:8px}

  .term-wrap{height:100%;display:flex;flex-direction:column}
  .term{flex:1;padding:18px;overflow:auto;background:linear-gradient(180deg,#071018,#02060a);}
  .line{white-space:pre-wrap}
  .promptline { display:flex; }
  .prompttext { white-space:pre; }
  .cmdline {
    outline:none;border:none;background:transparent;color:var(--text);font:inherit;flex:1;
    caret-color:var(--white); /* C1 choice */
  }
  .muted{color:var(--muted)}
  .accent{color:var(--accent)}
  ::selection{background:rgba(102,217,239,0.15)}
</style>
</head>
<body>

<div id="app">
  <div id="login" class="login-wrap">
    <div class="login">
      <h1>login</h1>
      <div class="small">Credentials read from <code>creds.json</code> if present.</div>
      <label>username</label>
      <input id="u" autocomplete="username" value="admiral" />
      <label>password</label>
      <input id="p" autocomplete="current-password" />
      <button id="btnLogin" class="btn">Sign in</button>
      <div class="small">Not secure. For aesthetic only.</div>
    </div>
  </div>

  <div id="terminal-screen" style="display:none;height:100%" class="term-wrap">
    <div id="term" class="term" tabindex="0"></div>
    <div style="padding:8px;background:rgba(0,0,0,0.08);border-top:1px solid rgba(255,255,255,0.04)">
      <div class="promptline">
        <span id="prompt" class="prompttext"></span>
        <input id="cmd" class="cmdline" autocomplete="off" spellcheck="false" />
      </div>
    </div>
  </div>
</div>

<script>
const DEFAULT_CREDS = { username:'admiral', password:'hunter2', whoami:'admiral' };
const FILES_BASE = '/files/';
let CREDS = {...DEFAULT_CREDS};
let currentUser = 'guest';
let cwd = '/';
let uptimeStart = Date.now();

const FS = {
  '/':{type:'dir',entries:['home','etc','README.txt']},
  '/home':{type:'dir',entries:['readme.md']},
  '/home/readme.md':{type:'file',content:'# Welcome\\nThis is a fake terminal.'},
  '/etc':{type:'dir',entries:['motd']},
  '/etc/motd':{type:'file',content:'This is not a secure system.'},
  '/README.txt':{type:'file',content:'Fake terminal v1.'}
};

// DOM
const loginWrap=document.getElementById('login');
const termScreen=document.getElementById('terminal-screen');
const term=document.getElementById('term');
const cmdInput=document.getElementById('cmd');
const promptEl=document.getElementById('prompt');

// Load creds.json
async function loadCreds(){
  try{
    const res=await fetch('/creds.json',{cache:'no-store'});
    if(!res.ok)throw new Error();
    const j=await res.json();
    if(j.username&&j.password) CREDS=j;
  }catch(e){CREDS={...DEFAULT_CREDS};}
  document.getElementById('u').value=CREDS.username;
  document.getElementById('p').value=CREDS.password;
}

function setPrompt(){
  const isRoot = (currentUser==='root');
  const userColor = isRoot?'var(--red)':'var(--green)';
  const pathColor = 'var(--blue)';
  const symColor  = isRoot?'var(--red)':'var(--white)';
  const symbol = isRoot?'#':'$';
  promptEl.innerHTML =
    `<span style="color:${userColor}">${currentUser}</span>`+
    `@github:`+
    `<span style="color:${pathColor}">${cwd}</span>`+
    ` <span style="color:${symColor}">${symbol}</span> `;
}

async function attemptLogin(){
  const u=document.getElementById('u').value.trim();
  const p=document.getElementById('p').value;
  if(u===CREDS.username && p===CREDS.password){
    currentUser = CREDS.whoami||CREDS.username;
    showTerminal();
  } else {
    printLine('invalid credentials','line muted');
  }
}

function showTerminal(){
  loginWrap.style.display='none';
  termScreen.style.display='flex';
  printLine(`Welcome, ${currentUser}. Type 'help' for commands.`);
  setPrompt();
  cmdInput.focus();
}

function printLine(text,cls='line'){
  const el=document.createElement('div'); el.className=cls; el.textContent=text;
  term.appendChild(el); term.scrollTop=term.scrollHeight;
}

cmdInput.addEventListener('keydown', async (e)=>{
  if(e.key==='Enter'){
    const raw=cmdInput.value.trim();
    printLine(promptEl.textContent+raw,'accent');
    await handleCommand(raw);
    cmdInput.value='';
    setPrompt();
  }
});

async function handleCommand(raw){
  const parts=raw.split(' ').filter(Boolean);
  const cmd=parts[0]?.toLowerCase()||'';
  const args=parts.slice(1);
  switch(cmd){
    case 'help': printLine("help ls cd pwd cat clear echo whoami date uptime filetree"); break;
    case 'ls': {
      const path=resolvePath(args[0]||cwd);
      if(FS[path]?.type==='dir') printLine(FS[path].entries.join('  '));
      else printLine('ls: no such directory','muted');
    } break;
    case 'pwd': printLine(cwd); break;
    case 'cd': {
      const target=resolvePath(args[0]||'/');
      if(FS[target]?.type==='dir'){cwd=target;} else printLine('cd: no such directory','muted');
    } break;
    case 'cat': if(!args[0]) printLine('cat: missing file','muted'); else await catCommand(resolvePath(args[0])); break;
    case 'clear': term.innerHTML=''; break;
    case 'echo': printLine(args.join(' ')); break;
    case 'whoami': printLine(currentUser); break;
    case 'date': printLine(new Date().toString()); break;
    case 'uptime': printLine(((Date.now()-uptimeStart)/1000).toFixed(1)+' seconds'); break;
    default: if(cmd) printLine('command not found: '+cmd,'muted');
  }
}

function resolvePath(input){
  if(!input) return cwd;
  if(input.startsWith('/')) return input.replace(/\\/+/g,'/')||'/';
  const combined=(cwd.endsWith('/')?cwd:cwd+'/')+input;
  const normalized=combined.split('/').reduce((a,p)=>{if(p===''||p==='.')return a;if(p==='..')a.pop();else a.push(p);return a;},[]);
  return '/'+normalized.join('/');
}

async function catCommand(path){
  if(FS[path]?.type==='file'){printLine(FS[path].content);return;}
  const name=path.startsWith('/')?path.slice(1):path;
  try{
    const r=await fetch(FILES_BASE+name,{cache:'no-store'});
    if(!r.ok)throw new Error(); printLine(await r.text());
  }catch{printLine('cat: file not found','muted');}
}

// focus on click
document.addEventListener('click',(ev)=>{
  if(getComputedStyle(termScreen).display!=='none' &&
     !ev.target.closest('input') &&
     !ev.target.closest('button')
  ){
    cmdInput.focus();
  }
});

loadCreds();
</script>
</body>
</html>
